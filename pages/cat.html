<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›½ç¾(GOME)-ç»¼åˆç½‘è´­å•†åŸï¼Œæ­£å“ä½ä»·ã€å“è´¨ä¿éšœã€å¿«é€Ÿé€è¾¾ã€å®‰å¿ƒæœåŠ¡ï¼</title>
    <link rel="SHORTCUT ICON" href="../images/Gome.ico">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/cat.css">
</head>

<body>
    <nav id="nav">
        <div class="container">
            <ul class="ulleft">
                <li><a class="me">å›½ç¾ä¼šå‘˜<i id="xjt"></i></a></li>
                <li><a href="./login.html">ç™»å½•</a></li>
                <li><a class="strong" href="./add.html">æ³¨å†Œæœ‰ç¤¼ç‰©</a></li>
            </ul>
            <ul class="ulright">
                <li><a href="javascrpit:;">æˆ‘çš„è®¢å•</a></li>
                <li><a>æˆ‘çš„å›½ç¾</a></li>
                <li><a href="javascrpit:;">ä¼ä¸šé‡‡è´­<i id="xjt"></i></a></li>
                <li><a href="javascrpit:;"><i id="serve"></i>æœåŠ¡ä¸­å¿ƒ<i id="xjt"></i></a></li>
                <li><a href="javascrpit:;">ç½‘ç«™å¯¼èˆª<i id="xjt"></i></a></li>
                <li><a href="javascrpit:;">æ‰‹æœºå›½ç¾<i id="xjt"></i></a></li>
            </ul>
        </div>
    </nav>
    <header>
        <div class="container">
            <h1>
                <a></a><img src="https://css.gomein.net.cn/gmpro/2.0.0/cart/3.1.27/css/i/gwc.png" alt=""></h1>
        </div>
    </header>
    <p class="p1 container"><strong> <i>!</i> è¿è´¹è¯´æ˜</strong><span>é…é€è‡³:<a>å¹¿ä¸œçœæ·±åœ³å¸‚å®å®‰åŒºè¥¿ä¹¡è¡—é“ <i></i> </a></span></p>
    <p class="p2 container"><span><input  type="checkbox" class="all"  >å…¨é€‰</span> <span>å•†å“ä¿¡æ¯</span><span>æ“ä½œ</span> <span>å°è®¡</span> <span>æ•°é‡</span> <span>å•ä»·</span></p>
    <div id="form" class="container">
        <p> <span><input type="checkbox" class="alls" >å›½ç¾ç½‘åº—</span> <span> <i></i> åœ¨çº¿å®¢æœ</span></p>
        <div class="matter">
            <span><input type="checkbox" class="sort"></span>
            <strong><img src="https://gfs17.gomein.net.cn/T1GiD5ByDv1RCvBVdK_450.jpg" alt=""></strong>
            <div class="recommend">
                <p>è£è€€(honor)è£è€€30é’æ˜¥ç‰ˆ6GB+128GBå…¨ç½‘é€šç‰ˆå¹»å¤œé»‘</p>
                <p><i>å•†å“ç¼–å·:</i> <span>100625078</span></p>
            </div>
            <div class="color">
                <p>é¢œè‰²: <span>å¹»å¤œé»‘</span> </p>
                <p>ç‰ˆæœ¬: <span>6+128GB</span></p>
            </div>
            <p class="priceone">
                ï¿¥2399.00
            </p>
            <div class="num">
                <span>-</span>
                <strong>1</strong>
                <span>+</span>
            </div>
            <p class="price">
                ï¿¥2399.00
            </p>
            <div class="operation">
                <p>åˆ é™¤</p>
                <p>ç§»å…¥æ”¶è—å¤¹</p>
            </div>
        </div>
        <div class="lose">
            <i></i>
            <div>
                <p>è´­ç‰©è½¦å†…æš‚æ— å•†å“ï¼Œç™»å½•åå°†æ˜¾ç¤ºæ‚¨ä¹‹å‰åŠ å…¥çš„å•†å“</p>
                <p><a href="./login.html">ç™»å½•</a> <a href="./GomeIndex.html">æŒ‘é€‰å•†å“ </a> </p>
            </div>
        </div>
    </div>
    <section id="footer">
        <div class="container">
            <span><input  type="checkbox"  class="All">å…¨é€‰</span>
            <span>åˆ é™¤</span>
            <span class="pay">å»ç»“ç®—</span>
            <span class="pri">
            æ€»è®¡(ä¸å«è¿è´¹)ï¼š<span>ï¿¥00.00</span>
            </span>
            <span class="sum">
            å·²é€‰æ‹©å…±<span>0</span>ä»¶ <i></i>
            </span>
        </div>
    </section>
</body>
<script src="../lib/jquery.min.js"></script>
<script src="../js/general.js"></script>
<script>
    $("header>div>h1").click(function() {
        location.href = "./GomeIndex.html"
    })
    if (getCookie("name")) {
        alert("è¯·ç¨å");
        $.ajax({
            url: "../interface/showlist.php",
            dataType: "json",
            type: "POST",
            data: {
                master: getCookie("name"),
            },
            success: function(res) {
                console.log(res.data);
                $.each(res.data, function(index, item) {
                    var sums = parseInt(item.price.split("ï¿¥")[1]) * item.num;
                    sums = "ï¿¥" + sums;
                    $("#form").append($(`<div class="matter">
            <span><input type="checkbox" class="sort"></span>
            <strong><img src=${item.img} alt=""></strong>
            <div class="recommend">
                <p>${item.name}</p>
                <p><i>å•†å“ç¼–å·:</i> <span>${item.serial}</span></p>
            </div>
            <div class="color">
                <p>é¢œè‰²: <span>${item.color}</span> </p>
                <p>ç‰ˆæœ¬: <span>${item.versions}</span></p>
            </div>
            <p class="priceone">
                ${item.price}
            </p>
            <div class="num">
                <span>-</span>
                <strong>${item.num}</strong>
                <span>+</span>
            </div>
            <p class="price">
                ${sums}
            </p>
            <div class="operation">
                <p>åˆ é™¤</p>
                <p>ç§»å…¥æ”¶è—å¤¹</p>
            </div>
         </div>`))
                })
                $(".lose").css("display", "none");
                $(".matter").css("display", "block");
                $("#form>p").css("display", "block");
                // ä¸€äº›å…¨é€‰æŒ‰é’®

                $(".all").click(function() {
                    if ($(".all").prop("checked") == true) {
                        $(".alls").prop("checked", true)
                        $(".All").prop("checked", true)
                        $(".sort").prop("checked", true)
                            .parent()
                            .parent()
                            .css({
                                background: "#fffaf4",
                            })
                    } else if ($(".all").prop("checked") == false) {
                        $(".alls").prop("checked", false)
                        $(".All").prop("checked", false)
                        $(".sort").prop("checked", false)
                            .parent()
                            .parent()
                            .css({
                                background: "#ffffff"
                            })
                    }
                    var a = 0;
                    var b = 0;
                    $.each($(".sort"), function(i, t) {
                        if ($(".sort").eq(i).prop("checked") == true) {
                            a++;
                            b += parseInt($(".price").eq(i).text().split("ï¿¥")[1]);
                        }
                    })
                    if (b == 0) {
                        $(".pri>span").text("ï¿¥00.00")
                        $(".sum>span").text("0")

                    } else {
                        b = "ï¿¥" + b.toFixed(2)
                        $(".sum>span").text(a);
                        $(".pri>span").text(b)
                    }
                })
                $(".alls").click(function() {
                    if ($(".alls").prop("checked") == true) {
                        $(".all").prop("checked", true)
                        $(".All").prop("checked", true)
                        $(".sort").prop("checked", true)
                            .parent()
                            .parent()
                            .css({
                                background: "#fffaf4",
                            })
                    } else if ($(".alls").prop("checked") == false) {
                        $(".all").prop("checked", false)
                        $(".All").prop("checked", false)
                        $(".sort").prop("checked", false)
                            .parent()
                            .parent()
                            .css({
                                background: "#ffffff"
                            })
                    }
                    var a = 0;
                    var b = 0;
                    $.each($(".sort"), function(i, t) {
                        if ($(".sort").eq(i).prop("checked") == true) {
                            a++;
                            b += parseInt($(".price").eq(i).text().split("ï¿¥")[1]);
                        }
                    })
                    if (b == 0) {
                        $(".sum>span").text("0")
                        $(".pri>span").text("ï¿¥00.00")
                    } else {
                        b = "ï¿¥" + b.toFixed(2)
                        $(".sum>span").text(a);
                        $(".pri>span").text(b)
                    }
                })
                $(".All").click(function() {
                        if ($(".All").prop("checked") == true) {
                            $(".all").prop("checked", true)
                            $(".alls").prop("checked", true)
                            $(".sort").prop("checked", true)
                                .parent()
                                .parent()
                                .css({
                                    background: "#fffaf4",
                                })
                        } else if ($(".All").prop("checked") == false) {
                            $(".all").prop("checked", false)
                            $(".alls").prop("checked", false)
                            $(".sort").prop("checked", false)
                                .parent()
                                .parent()
                                .css({
                                    background: "#ffffff"
                                })
                        }

                        var a = 0;
                        var b = 0;
                        $.each($(".sort"), function(i, t) {
                            if ($(".sort").eq(i).prop("checked") == true) {
                                a++;
                                b += parseInt($(".price").eq(i).text().split("ï¿¥")[1]);
                            }
                        })
                        if (b == 0) {
                            $(".sum>span").text("0")
                            $(".pri>span").text("ï¿¥00.00")
                        } else {
                            b = "ï¿¥" + b.toFixed(2)
                            $(".sum>span").text(a);
                            $(".pri>span").text(b)
                        }
                    })
                    // é€‰æ‹©çš„å•†å“
                $(".sort").click(function() {
                        if ($(this).prop("checked") == true) {
                            $(this)
                                .parent()
                                .parent()
                                .css({
                                    background: "#fffaf4",
                                })

                        } else if ($(this).prop("checked") == false) {
                            $(this)
                                .parent()
                                .parent()
                                .css({
                                    background: "#ffffff",
                                })
                        }

                        var a = 0;
                        var b = 0;
                        $.each($(".sort"), function(i, t) {
                            if ($(".sort").eq(i).prop("checked") == true) {
                                a++;
                                b += parseInt($(".price").eq(i).text().split("ï¿¥")[1]);
                            }
                        })
                        if (b == 0) {
                            $(".pri>span").text("ï¿¥00.00")
                            $(".sum>span").text("0")
                        } else {
                            b = "ï¿¥" + b.toFixed(2)
                            $(".sum>span").text(a);
                            $(".pri>span").text(b)
                        }

                    })
                    // åŠ å‡æŒ‰é’®
                $.each($(".matter"), function(i, t) {
                    var num = $(".matter>.num>strong").eq(i).text();
                    var nums;
                    var time
                    $(`.matter>.num:eq(${i})>span`).eq(0).click(function() {
                        if ($(".matter>.num>strong").eq(i).text() > 1) {
                            num--;
                            $(".matter>.num>strong").eq(i).text(num);
                            nums = (parseInt($(`.matter>.priceone`).eq(i).text().split("ï¿¥")[1]) * num).toFixed(2)
                            nums = "ï¿¥" + nums;
                            $(".price").eq(i).text(nums);
                            var m = $(`.matter:eq(${i})>.recommend>p:eq(1)>span`).text();
                            var n = $(`.matter:eq(${i})>.num>strong`).text()
                            if (time) {
                                clearInterval(time)
                            }
                            time = setTimeout(() => {
                                $.ajax({
                                    url: "../interface/updatewq.php",
                                    data: {
                                        num: n,
                                        master: getCookie("name"),
                                        id: m,
                                    },
                                    type: "POST",
                                    success: function(res) {
                                        var res = JSON.parse(res);
                                        if (res.code == 1) {
                                            alert("ä¿®æ”¹æˆåŠŸ")
                                        }
                                    }
                                })
                            }, 2000)
                        }

                    })
                    $(`.matter>.num:eq(${i})>span`).eq(1).click(function() {
                        num++;
                        $(".matter>.num>strong").eq(i).text(num);
                        nums = (parseInt($(`.matter>.priceone`).eq(i).text().split("ï¿¥")[1]) * num).toFixed(2);
                        nums = "ï¿¥" + nums;
                        $(".price").eq(i).text(nums)
                        var m = $(`.matter:eq(${i})>.recommend>p:eq(1)>span`).text()
                        var n = $(`.matter:eq(${i})>.num>strong`).text();
                        if (time) {
                            clearInterval(time)
                        }
                        time = setTimeout(() => {
                            $.ajax({
                                url: "../interface/updatewq.php",
                                data: {
                                    num: n,
                                    master: getCookie("name"),
                                    id: m,
                                },
                                type: "POST",
                                success: function(res) {
                                    var res = JSON.parse(res);
                                    if (res.code == 1) {
                                        alert("ä¿®æ”¹æˆåŠŸ")
                                    }
                                }
                            })
                        }, 2000)
                    })
                    $(`.operation>p:eq(${i})`).click(function() {
                        var m = $(`.matter:eq(${i})>.recommend>p:eq(1)>span`).text()

                        $(this).parent().parent().remove();
                        $.ajax({
                            url: "../interface/delwq.php",
                            type: "POST",
                            dataType: "json",
                            data: {
                                master: getCookie("name"),
                                id: m,
                            },
                            success: function(res) {
                                if (res.code == 1) {
                                    alert("åˆ é™¤æˆåŠŸ")
                                }
                            }
                        })
                    })

                })

                if ($(".matter").length == 0) {
                    var fla = confirm("è´­ç‰©è½¦è¿˜æ²¡æœ‰ä¸œè¥¿å‘¢ï¼Œç°åœ¨å»æŒ‘é€‰ä¸œè¥¿æŠŠğŸ˜”");
                    if (fla) {
                        location.href = "./GomeIndex.html";
                    }
                }
            }

        })
    }
</script>

</html>